% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/trait_analysis.R
\name{analyze_trait_changes}
\alias{analyze_trait_changes}
\title{Perform group-wise statistical testing on glycan trait matrices
stored in a `SummarizedExperiment`.}
\usage{
analyze_trait_changes(trait_se, group_col, group_levels, min_psm = 20)
}
\arguments{
\item{trait_se}{A `SummarizedExperiment` object produced by `build_trait_se()`,
containing glycan trait matrices in its assays.}

\item{group_col}{A character string specifying the name of the metadata column in
`colData(trait_se)` used to define group membership.}

\item{group_levels}{A character vector specifying which values within `group_col` should
be compared. Typically length 2 (e.g., `c("Control","Treatment")`),
but can contain more values if desired.}

\item{min_psm}{Minimum number of PSMs required in both comparison groups for a site
or protein to be included in the analysis. Default is `20`.}
}
\value{
A data.frame containing rows for significant trait–site combinations
with the following columns:

* `trait`  — glycan trait name
* `level`  — glycopeptide or protein identifier
* `l_pval` — Levene test p-value
* `f_val`  — Levene test F statistic
* `t_pval` — Welch t-test p-value
* `t_val`  — Welch t statistic
}
\description{
This function performs differential analysis of glycan traits across
experimental groups using per-site (or per-protein) trait matrices
generated by `build_trait_se()`.
For each glycan trait and each glycopeptide/protein level, a
two-sample Welch t-test and a Levene's test for variance equality
are performed between user-specified groups.

Rows correspond to glycosylation sites or proteins (depending on how
the `SummarizedExperiment` was constructed), and columns correspond
to PSMs.

Only comparisons where both groups meet the minimum PSM threshold
(`min_psm`) are evaluated.
Boolean traits (all-zero vectors) are automatically skipped.
}
\details{
Differential Analysis of Glycan Traits Between Experimental Groups


For each glycan trait:

1. Extract the PSM-level intensities for the specified groups.
2. Remove missing values (`NA`s).
3. Skip if either group has fewer than `min_psm` PSMs.
4. Skip if the trait is all-zero (boolean-like traits).
5. Run Welch's t-test (`t.test(value ~ group)`).
6. Run Levene's test (`car::leveneTest`, median-centered).

A result is returned only if *either* the t-test or Levene's test
yields a p-value < 0.05.
}
\examples{
\dontrun{
# Assume `se` is a SummarizedExperiment from build_trait_se()

res <- analyze_trait_changes(
  trait_se    = se,
  group_col   = "condition",
  group_levels = c("Control", "Treatment"),
  min_psm      = 20
)

head(res)
}

}
\seealso{
* [build_trait_se()] — constructs the trait SummarizedExperiment
* `car::leveneTest`
* `t.test`
}
