![R](https://img.shields.io/badge/R-glycoproteomics-blue?style=flat-square) ![status](https://img.shields.io/badge/status-active-success?style=flat-square) ![license](https://img.shields.io/badge/license-MIT-green?style=flat-square)

# glycoTraitR

**glycoTraitR** is an R package for **extracting, summarizing, and analyzing glycan structural traits** from GPSM data generated by **pGlyco3** or **Glyco-Decipher**.

It provides a streamlined workflow for:

-   parsing WURCS 2.0 and pGlyco3 glycan strings
-   computing composition & structural traits
-   summarizing glycan–PSM trait matrices at site/protein level (`SummarizedExperiment`)
-   performing differential trait analysis and visualizing trait changes

# Download Package
``` r
# install.packages("devtools")
devtools::install_github("matsui-lab/glycoTraitR")
```

# Package Workflow

``` text
  pGlyco3 / Decipher GPSM
            │
            ▼
   Parse glycan strings
            │
            ▼
 Compute glycan traits (composition + structure)
            │
            ▼
 SummarizedExperiment (trait × PSM)
            │
            ▼
 Differential analysis & plots
```

# Quick Start

This example uses publicly available pGlyco3 GPSM data hosted on **Zenodo**.

## 1. Download example data

``` r
library(glycoTraitR)

# GPSM file from Zenodo
url <- "https://zenodo.org/records/17756830/files/pGlycoDB-GP-FDR-Pro-Quant-Site.txt?download=1"
download.file(url, "pGlyco3_GPSM.txt", mode = "wb")

gpsm <- read_pGlyco3_gpsm("pGlyco3_GPSM.txt")
head(gpsm)
```

## 2. Load metadata

``` r
meta_url <- "https://zenodo.org/records/17756830/files/meta_example.rds?download=1"
download.file(meta_url, "meta_example.rds", mode = "wb")
meta <- readRDS("meta_example.rds")
```

## 3. Build glycan trait matrices

``` r
trait_se <- build_trait_se(
  gpsm,
  from = "pGlyco3",
  motifs = NULL,
  level = "protein",
  meta = meta
)

trait_se
```

## 4. Differential analysis

``` r
res <- analyze_trait_changes(
  trait_se     = trait_se,
  group_col    = "Diagnosis",
  group_levels = c("Normal", "Symptomatic"),
  min_psm      = 20
)

head(res)
```

## 5. Trait distribution visualization

``` r
p <- plot_trait_distribution(
  trait_se     = trait_se,
  group_col    = "Diagnosis",
  group_levels = c("Normal", "Symptomatic"),
  trait_name   = "Antennas",
  feature      = "LAMP2"
)

p$p_hist
p$p_box
```

------------------------------------------------------------------------

# Contributing

Contributions are welcome! For questions or collaboration, feel free to contact: zhang.bingyuan.w8 [at] f.mail.nagoya-u.ac.jp
